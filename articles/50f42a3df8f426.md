---
title: "komorebiã‚’å°å…¥ã—ã¦ã¿ã‚‹"
emoji: "ğŸŒ¿"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["komorebi"]
published: true
---

# komorebiã‚’å°å…¥ã—ã¦ã¿ã‚‹

ç­†è€…ã¯æ™®æ®µmanjaro/i3wmã§é–‹ç™ºã‚’ã—ã¦ã„ã‚‹ã€‚

ã—ã‹ã—ã€Windowsã‚’ä½¿ã‚ã–ã‚‹ã‚’å¾—ãªããªã£ã¦ã—ã¾ã£ãŸã®ã§ã€Windowsã§ä½¿ãˆã‚‹Tiling WMã‚’æ¢ã—ãŸæ‰€ã€[komorebi](https://github.com/LGUG2Z/komorebi)ã‚’è¦‹ã¤ã‘ãŸã€‚

ã“ã®è¨˜äº‹ã¯komorebiã®å°å…¥ã¨å€‹äººçš„ã«è©°ã¾ã£ãŸæ‰€ã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã‚ã‚‹ã€‚

:::message
komorebiä»¥å¤–ã«ã‚‚[bug.n](https://github.com/fuhsjr00/bug.n)ã‚’è¦‹ã¤ã‘ãŸãŒã€ç­†è€…ã®ç’°å¢ƒï¼ˆãƒãƒ«ãƒãƒ¢ãƒ‹ã‚¿ï¼‰ã§ã¯ã†ã¾ãã‚¿ã‚¤ãƒªãƒ³ã‚°ãŒå‹•ä½œã—ãªã‹ã£ãŸã®ã§æ¡ç”¨ã—ãªã‹ã£ãŸã€‚
:::

:::message alert
ç­†è€…ã¯Windowsã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³/PowerShellã«ä¸æ…£ã‚Œã§ã‚ã‚‹ãŸã‚ã€èªè­˜é•ã„ã‚„è‰¯ããªã„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ã„ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚
:::


## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ç­†è€…ã¯Windowsã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†ã«[winget](https://github.com/microsoft/winget-cli)ã‚’ä½¿ã£ã¦ã„ã‚‹ã€‚

komorebiã¯2022/08/26ç¾åœ¨[wingetã‚’ä½¿ã£ãŸã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«å¯¾å¿œã—ã¦ã„ãªã„](https://github.com/LGUG2Z/komorebi/issues/152)ã®ã§Github Releaseã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚

ä»¥ä¸‹ã¯powershellã‚’ä½¿ã£ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã‚ã‚‹ã€‚

```powershell
$UserProfile = $env:USERPROFILE
$MyAppDir = (Join-Path -Path $HOME -ChildPath "apps")

$komorebiRelease = Invoke-RestMethod -uri "https://api.github.com/repos/LGUG2Z/komorebi/releases/latest"
$komorebiReleaseInfo = $komorebiRelease.assets | Where { $_.browser_download_url.EndsWith(".zip") } | Select -First 1
$outFile = (Join-Path -Path $UserProfile -ChildPath "downloads" | Join-Path -ChildPath $komorebiReleaseInfo.name)
Invoke-WebRequest -Uri $komorebiReleaseInfo.browser_download_url -OutFile $outFile
Expand-Archive -LiteralPath $outFile -Destination (Join-Path -Path $MyAppDir -ChildPath "komorebi")
Remove-Item $outFile -Recurse
```


:::message
[scoopã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã¯ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã§ã™ã€‚](https://github.com/LGUG2Z/komorebi#scoop)
```powershell
scoop bucket add extras
scoop install komorebi

# To download the example configuration
iwr https://raw.githubusercontent.com/LGUG2Z/komorebi/master/komorebi.sample.ahk -OutFile $Env:USERPROFILE\komorebi.ahk
iwr https://raw.githubusercontent.com/LGUG2Z/komorebi/master/komorebic.lib.ahk -OutFile $Env:USERPROFILE\komorebic.lib.ahk
iwr https://raw.githubusercontent.com/LGUG2Z/komorebi/master/komorebi.generated.ahk -OutFile $Env:USERPROFILE\komorebi.generated.ahk
```
:::

## èµ·å‹•

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆã«PATHã‚’é€šã—ãŸä¸Šã§`komorebic start`ã§komorebiãŒèµ·å‹•ã™ã‚‹ã€‚

çµ‚äº†ã¯`komorebic stop`ã§ã§ãã‚‹ã€‚

ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«è‡ªå‹•ã§komorebiãŒèµ·å‹•ã™ã‚‹ã‚ˆã†ã«ã€ç­†è€…ã¯æ¬¡ã®ã‚ˆã†ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ã„ã¦ã„ã‚‹ã€‚

```powershell
function Create-ShortCut {
    param([string]$Source, [string[]]$Arguments, [string]$Destination, [int]$WindowStyle)
    $WScriptShell = New-Object -ComObject WScript.Shell
    $executableName = Split-Path $Source -Leaf
    $name = $executableName.SubString(0, $executableName.LastIndexOf("."))
    $dst = Join-Path -Path (Resolve-Path -Path $Destination) -ChildPath ($name + ".lnk")
    $Shortcut = $WScriptShell.CreateShortcut($dst)
    $Shortcut.Targetpath = $Source
    if ($Arguments.count -gt 0) {
        $Shortcut.Arguments = $Arguments -join " "
    }
    if ($WindowStyle -gt 0) {
        # 1: normal
        # 3: maximize
        # 7: minimize
        $Shortcut.WindowStyle = $WindowStyle
    }
    $Shortcut.Save()

    Write-Host "Generate shortcut as $dst"
}

Create-ShortCut -Source (Join-Path -Path $MyAppDir -ChildPath "komorebi" | Join-Path -ChildPath "komorebic.exe")`
                -Arguments "start" `
                -Destination (Get-ItemProperty 'HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders').StartUp `
                -WindowStyle 7
```

## è¨­å®š

komorebiã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã¯ã™ã¹ã¦AutoHotKeyã‚’ä½¿ã£ã¦è¨­å®šã™ã‚‹ã€‚

komorebiã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«AutoHotKeyãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ã‚ã‘ã§ã¯ãªã„ã®ã§ã€ã“ã‚Œã‚‚wingetã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```powershell
winget install --exact --id Lexikos.AutoHotKey
```

è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã ã¨`komorebi.exe`ã‚„`komorebic.exe`ã¨åŒéšå±¤ã«ã‚ã‚‹`komorebi.ahk`ã§ã‚ã‚‹ã“ã¨ãŒæœŸå¾…ã•ã‚Œã‚‹ã€‚

ã“ã‚Œã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ç’°å¢ƒå¤‰æ•°`KOMOREBI_CONFIG_HOME`ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ã®ãƒ‘ã‚¹ã‚’è¨­å®šã—ã€ãã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸‹ã«`komorebi.ahk`ã‚’ç½®ãã“ã¨ã§`komorebic start`ã®å®Ÿè¡Œæ™‚ã«è‡ªå‹•ã§ãƒ•ã‚¡ã‚¤ãƒ«ãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹ã€‚

`komorebi.ahk`ã®é››å½¢ã¯`komorebic.exe`ã¨åŒã˜éšå±¤ã«`komorebi.sample.ahk`ãŒã‚ã‚‹ã®ã§ã€ã“ã‚Œã‚’å‚è€ƒã«ã™ã‚‹ã¨ã‚ˆã•ãã†ã€‚

ç­†è€…ã®`komorebi.ahk`ã¯[githubã®dotfilesãƒªãƒã‚¸ãƒˆãƒª](https://github.com/Omochice/dotfiles/blob/main/config/komorebi/komorebi.ahk)ã§ç®¡ç†ã—ã¦ã„ã‚‹ã€‚



## è©°ã¾ã£ãŸã¨ã“ã‚

- wingetã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸAutoHotKeyã«ãƒ‘ã‚¹ãŒé€šã£ã¦ã„ãªã„
ç­†è€…ã®ç’°å¢ƒã§ã¯wingetã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã‚¢ãƒ—ãƒªã«ãƒ‘ã‚¹ãŒé€šã£ã¦ã„ãªã„ã“ã¨ãŒã‚ã‚‹ã€‚
ãã®ãŸã‚ã€å¿…è¦ã«å¿œã˜ã¦ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§PATHã‚’è¿½åŠ ã™ã‚‹ã€‚
```powershell
[Environment]::SetEnvironmentVariable("PATH", $Env:PATH + ";" + (Join-Path -Path $Env:ProgramW6432 -ChildPath "AutoHotKey"), [EnvironmentVariableTarget]::Machine)
```

:::message
PATHã®è¿½åŠ ã«`$Env:PATH += ";" + "<è¿½åŠ ã—ãŸã„PATH>"`ã®å½¢å¼ã§ã¯ãªã`[Environment]...`ã®å½¢å¼ã‚’ä½¿ã£ã¦ã„ã‚‹ãŒã€ã“ã‚Œã¯ãƒ‘ã‚¹ã‚’æ°¸ç¶šåŒ–ã™ã‚‹ãŸã‚ã§ã‚ã‚‹ã€‚
(PATHã®è¨­å®šã‚’ã—ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’èª­ã¿è¾¼ã‚“ã ãƒ—ãƒ­ã‚»ã‚¹ã®å­ãƒ—ãƒ­ã‚»ã‚¹ã ã‘æœ‰åŠ¹åŒ–ã•ã‚Œã‚‹ã®ã§ã¯ãªãã€å¸¸ã«PATHãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã¦ã»ã—ã„)
:::

- PowerToysã®keyboard managerã¨ã®åŒæ™‚ä½¿ç”¨
PowerToys keyboard managerã¨komorebi(AutoHotKey)ã‚’åŒæ™‚ã«ä½¿ã†ã¨PowerToyså´ãŒå„ªå…ˆã•ã‚Œã‚‹ã€‚
ãã®ãŸã‚ã€åŒã˜ã‚­ãƒ¼ã«å¯¾ã—ã¦ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ã™ã‚‹éš›ã«ã¯æ³¨æ„ãŒå¿…è¦ã€‚

- Win+lã«ãƒãƒƒãƒ”ãƒ³ã‚°ã—ãŸã„
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®windowsã®æŒ™å‹•ã§ã¯Win+lã®ã‚­ãƒ¼ã«ã¯ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã®ãƒ­ãƒƒã‚¯ãŒãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã€‚
ã“ã‚Œã¯PowerToysã§ã‚‚ä¸Šæ›¸ãã§ããªã„ã®ã§ã€ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚’æ›¸ãæ›ãˆã¦ç„¡åŠ¹åŒ–ã™ã‚‹ã€‚
```powershell
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\system" /v "DisableLockWorkstation" /t REG_DWORD /d "1" /f
```

ã“ã‚Œã‚’ä»–ã®ã‚­ãƒ¼ã«ãƒªãƒãƒƒãƒ—ã™ã‚‹ã«ã¯è‹¥å¹²é¢å€’ãªæ‰‹é †ã‚’è¸ã¾ãªã„ã¨å®Ÿç¾ã§ããªã„ã€‚
    1. ã‚­ãƒ¼æŠ¼ä¸‹æ™‚ã«LockWorkStationã‚’æœ‰åŠ¹åŒ–ã™ã‚‹
    2. `DllCall("user32\LockWorkStation")`
    3. å†åº¦ç„¡åŠ¹åŒ–ã™ã‚‹
ã®ã‚ˆã†ãªæ‰‹é †ãŒå¿…è¦ã ãŒã€komorebiã®ãƒ—ãƒ­ã‚»ã‚¹ãŒç®¡ç†è€…æ¨©é™ã®ã‚ã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§èµ·å‹•ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã‚­ãƒ¼æŠ¼ä¸‹æ™‚ã«ç¢ºèªãŒå…¥ã‚‹ã®ã§ãªã‚“ã¨ã‹ã—ãŸã„ã€‚(ã¾ã è§£æ±ºç­–ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œã¦ã„ãªã„)

## ç’°å¢ƒ

ã‚¨ãƒ‡ã‚£ã‚·ãƒ§ãƒ³	Windows 10 Pro
ãƒãƒ¼ã‚¸ãƒ§ãƒ³	21H1

```powershell
$ komorebi --version
komorebi 0.1.12

$ winget --version
v1.3.2091
```



